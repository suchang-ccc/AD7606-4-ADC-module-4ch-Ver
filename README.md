# AD7606-4-ADC-module
A 16bit 200Ksps parallel ADC module—form ADI
项目功能
四路模拟信号采集，且为同步采样。配置为16位并行输出，连接FPGA进行数据采集。
板子配置：

板子的5V和3V3均由排母直接连接FPGA开发板的管脚，由fpga进行供电，使用LC滤波进行数字模拟电源的隔离。
板子分为模拟地和信号地，在板子左下角使用磁珠进行共地。
PCB使用的是四层叠层，保证了地平面的完整和低阻抗。
每一个通道都使用SMA作为接口并预留有两个焊盘方便调试。

原理解析（硬件说明）
AD7606这个adc没有内部寄存器，所有功能都使用管脚电平进行配置，本次设计主要关注以下几个配置的点：

AD7606的BUSY引脚电平为高时表示AD正在进行转换，变低表示转换完成。将BUSY引脚接到STM32的外部中断引脚并配置为下降沿触发，这样可以在AF转换完成后及时读取数据。
OS［0..2］为过采样配置引脚，通过控制STM32相关GPIO的电平可以是AD7606工作在不同的过采样状态。
CONVST_A，CONVST_B为转换触发信号，上升沿触发。对于每一个AD7606来说，CONVST_A控制模拟通道14，CONVST_B控制模拟通道58。由于需要对所有通道同步采样，因此将CONVST_A，CONVST_B引脚同时连接在一个触发信号引脚上以实现同步采样（本模块直接连接）。
REFOUT引脚为外部基准电压输入引脚。AD7606可以配置为使用内部基准电压或外部基准电压。当两片AD7606同时工作时，使用外部基准电压可以保证所有输入通道转换精度的一致性（本模块使用内部参考）。
RANGE：模拟输入范围选择。逻辑输入。此引脚的极性决定模拟输入通道的输入范围。如果此引脚与逻辑高电平相连，则所有通道的模拟输入范围为±10 V。如果此引脚与逻辑低电平相连，则所有通道的模拟输入范围为±5 V。此引脚的逻辑状态改变会立即影响模拟输入范围。
ADRD :读信号。选择并行接口时为并行数据读取控制输入(RD)/选择串行接口时为串行时钟输入(SCLK)。在并行模式下，如果CS和RD均处于逻辑低电平，则会启用输出总线。在串行模式下，此引脚用作数据传输的串行时钟输入。CS下降沿使数据输出线路DourA和DouB脱离三态，并逐个输出转换结果的MSB。SCLK上升沿将随后的所有数据位逐个送至串行数据输出DouA和DouB。
ADRESET:复位信号。当设置为逻辑高电平时，RESET上升沿复位AD7606/AD7606-6/AD7606-4。器件应该在上电后收到一个RESET脉冲。RESET高脉冲宽度典型值为50ns。如果在转换期间施加RESET脉冲，转换将中断。如果在读取期间施加RESET脉冲，输出寄存器的内容将复位至全0。
ADBUSY :忙信号。CONVST A和CONVST B均达到上升沿之后，此引脚变为逻辑高电平，表示转换过程已开始。BUSY输出保持高电平，直到所有通道的转换过程完成为止。BUSY下降沿表示转换数据正被锁存至输出数据寄存器，经过时间t,之后便可供读取。在BUSY为 高电平时执行的数据读取操作应当在BUSY下降沿之前完成。当BUSY信号为高电平时，CONVST A或CONVST B的上升沿不起作用。
ADCS :片选信号。此低电平有效逻辑输入使能数据帧传输。在并行模式下，如果CS和RD均处于逻辑低电平，则会使能输出总线DB[15:0]，使转换结果输出在并行数据总线上。在串行模式下，利用Cs使能串行数据帧传输，并逐个输出串行输出数据的最高有效位(MSB)。
FRSTDATA：数字输出。FRSTDATA输出信号指示何时在并行、字节或串行接口上回读第-通道V1。当CS输入为高电平时，FRSTDATA输 出引脚处于三态。CS下降沿使FRSTDATA脱离三态。在并行模式下，与V1结果相对应的RD下降沿随后将FRSTDATA引脚设为高电平，表示输出数据总线可以提供V1的结果。在RD的下一个下降沿之后，FRSTDATA输出恢复逻辑低电平。在串行模式下，FRSTDATA在CS下降沿变为高.电平，因为此时将在DourA上输出V1的MSB。在CS 下降沿之后的第16个SCLK下降沿，它恢复低电平。
DB0-DB15数据总线：
并行输出数据位DB6至DB0：当PAR/SER/BYTE SEL = 0时，这些引脚充当三态并行数字输入/输出引脚。当PARCS和RD均处于低电平时，这些引脚用来输出转换结果的DB6至DB0。当PAR/SER/BYTE SEL = 1时，这些引脚应与AGND相连。当工作在并行字节接口模式时，DB[7:0]通 过2个RD操作输出16位转换结果。DB7(引脚24)为MSB，DB0为LSB。逻辑电源输入。此引脚的电源电压(2.3 V至5.25 V)决定逻辑接口的工作电压。此引脚的标称电源与主机接口(即DSP和FPGA)电源相同。
并行输出数据位7(DB7)/串行接口数据输出引脚(DouA)：
当PAR/SER/BYTE SEL = 0时，此引脚充当三态并行数字输入/输出引脚。当CS和RD均处于低电平时，此引脚用来输出转换结果的DB7。当PAR/SER/BYTE SEL= 1时，此引脚用作DouA,并输出串行转换数据，当工作在并行字节模式时，DB7为该字节的MSB。

并行输出数据位8(DB8)/串行接口数据输出引脚DO_B)：
当PAR/SER/BYTESEL= 0时，此引脚充当三态并行数字输入/输出引脚。当CS和RD均处于低电平时，此引脚用来输出转换结果的DB8。当PAR/SER/BYTE SEL= 1时，此引脚用作Dou B,并输出串行转换数据。

并行输出数据位DB13至DB9：
当PAR/SER/BYTESEL= 0时，这些引脚充当三态并行数字输入/输出引脚。当CS和RD均处于低电平时，这些引脚用来输出转换结果的DB13至DB9。当PAR/SER/BYTESEL= 1时，这些引脚应与AGND相连。

并行输出数据位14 (DB14)/高字节使能(HBEN)：
当PAR/SER/BYTE SEL = 0时，此引脚充当三态并行数字输出引脚。当CS和RD均处于低电平时,此引脚用来输出转换结果的DB14。当PAR/SER/BYTE SEL = 1且DB15/BYTESEL = 1时，AD7606/ AD7606-6/AD7606-4.工作在并行字节接口模式。在并行字节模式下，HBEN引脚用来选择是首先输出转换结果的高字节(MSB)还是低字节(LSB)。当HBEN= 1时，首先输出MSB，然后输出LSB。当HBEN= 0时，首先输出LSB,然后输出MSB。

并行输出数据位15(DB15)/并行字节模式选择(BYTESEL)：
当PAR/SER/BYTE SEL = 0时,此引脚充当三态并行数字输出引脚。当CS和RD均处于低电平时，此引脚用来输出转换结果的DB15。当PAR/SER/BYTESEL= 1时，BYTE SEL引脚用来在串行接口模式与并行字节接口模式之间做出选择。当PAR/SER/BYTE SEL = 1且DB15/BYTE SEL = 0时,AD7606工作在串行接口模式。当PAR/SER/BYTE SEL = 1且DB15/BYTE SEL= 1时，AD7606工作在并行字节接口模式。

本项目所有可配置的引脚都使用焊盘作为跳线进行配置，以节省fpga的io口，使用者可以根据自身需求自行选择。

###软件代码
本模块使用fpga作为并行输出数据的采集端，使用vivado的Verilog编写，实现在ILA里同步观测四个通道采集的波形，vivado工程见附件。


###注意事项
1.无法正常运行时优先检查42脚（REFIN/REFOUT）的电压，正常应是2.5V左右。
2.R2R4R6R8默认NC，如果有其他抗混叠需求的话再按需计算RC的值。
3.ADC只引出了必要的IO口，其他工作状态引脚均由板子上的焊盘设置。
4.测试的工程是vivado 2025.1版本的，只用了一个ila核，测试时候发现ch3ch4通道坏了，不想买新的换就没测了，程序上交叉验证过了，采样逻辑是正常的。
